{"ast":null,"code":"var _jsxFileName = \"I:\\\\ANYcode\\\\react\\\\samroiyod_next-app\\\\src\\\\Components\\\\Dent.jsx\";\nimport React, { Component } from 'react';\nimport { CookiesProvider, withCookies } from 'react-cookie';\nimport { Card, Modal, Input, Button, Col, message, Select, DatePicker, Table, Tag, Popconfirm } from 'antd';\nimport CryptoJS from 'crypto-js';\nimport Logo from '../favicon.ico';\nimport moment from 'moment';\nconst Option = Select.Option;\nvar date = new Date();\ndate = \"\".concat(date.getFullYear(), \"-\").concat((\"0\" + (date.getMonth() + 1)).slice(-2), \"-\").concat((\"0\" + date.getDate()).slice(-2));\n\nclass Dent extends Component {\n  constructor() {\n    super();\n\n    this.delCook = () => {\n      const cookies = this.props.cookies;\n      cookies.remove('user');\n      cookies.remove('pass');\n    };\n\n    this.dateChange = (a, b) => {\n      //console.log(b)\n      if (b === \"\") {} else {\n        this.setState({\n          selectDate: b\n        });\n        fetch(\"http://183.88.219.85:7078/appoint/view_appoint.php\", {\n          method: \"POST\",\n          body: JSON.stringify({\n            dates: b,\n            point: 1\n          })\n        }).then(view => view.json()).then(view => {\n          this.setState({\n            view: view\n          });\n        });\n      }\n    };\n\n    this.Edits = e => {\n      console.log(e);\n      this.setState({\n        modal: true\n      });\n      fetch(\"http://183.88.219.85:7078/appoint/view_edit.php\", {\n        method: \"POST\",\n        body: JSON.stringify({\n          id: e\n        })\n      }).then(view_edit => view_edit.json()).then(view_edit => {\n        this.setState({\n          dataEdit: view_edit\n        });\n      });\n    };\n\n    this.dateEdit = (a, b) => {\n      this.setState({\n        dateEdit: b\n      });\n      fetch(\"http://183.88.219.85:7078/appoint/select_time_edit.php\", {\n        method: \"POST\",\n        body: JSON.stringify({\n          dateEdit: b,\n          pointEdit: this.state.dataEdit.map(a => a.service_pont).toString()\n        })\n      }).then(time => time.json()).then(time => {\n        this.setState({\n          time: time\n        });\n      });\n    };\n\n    this.timeEdit = e => {\n      console.log(e);\n      this.setState({\n        timeEdit: e\n      });\n    };\n\n    this.modalOk = () => {\n      let newTime = this.state.timeEdit,\n          newDate = this.state.dateEdit,\n          updateId = this.state.dataEdit.map(a => a.service_id).toString();\n\n      if (newTime === \"\" || newDate === \"\" || updateId === \"\") {\n        message.error(\"แก้ไขข้อมูลผิดพลาด\");\n        console.log(newDate, newTime, updateId);\n      } else {\n        fetch(\"http://183.88.219.85:7078/appoint/update_service.php\", {\n          method: \"POST\",\n          body: JSON.stringify({\n            date: newDate,\n            time: newTime,\n            id: updateId\n          })\n        }).then(() => fetch(\"http://183.88.219.85:7078/appoint/view_appoint.php\", {\n          method: \"POST\",\n          body: JSON.stringify({\n            dates: this.state.selectDate,\n            point: this.state.selectPoint\n          })\n        }).then(view => view.json()).then(view => {\n          this.setState({\n            view: view\n          });\n        })).then(() => {\n          message.success(\"UPDATE SUCCESS\");\n          this.setState({\n            dateEdit: \"\",\n            timeEdit: \"\",\n            time: []\n          });\n        });\n      }\n\n      this.setState({\n        modal: false\n      });\n      console.log(newDate, newTime, updateId);\n    };\n\n    this.modalCancal = () => {\n      this.setState({\n        modal: false\n      });\n    };\n\n    this.confirmDel = e => {\n      console.log(e);\n      let userUpdate = this.state.empoye.map(a => a.person_firstname + \" \" + a.person_lastname).toString();\n      fetch(\"http://183.88.219.85:7078/appoint/cancel_appoint.php\", {\n        method: \"POST\",\n        body: JSON.stringify({\n          id: e.toString(),\n          user: userUpdate\n        })\n      }).then(() => fetch(\"http://183.88.219.85:7078/appoint/view_appoint.php\", {\n        method: \"POST\",\n        body: JSON.stringify({\n          dates: this.state.selectDate,\n          point: this.state.selectPoint\n        })\n      }).then(view => view.json()).then(view => {\n        this.setState({\n          view: view\n        });\n      })).then(() => {\n        message.success(\"ยกเลิกนัดสำเร็จ\");\n        this.setState({\n          dateEdit: \"\",\n          timeEdit: \"\",\n          time: [],\n          modal: false\n        });\n      });\n    };\n\n    this.state = {\n      dateEdit: \"\",\n      timeEdit: \"\",\n      modal: false,\n      time: [],\n      point: [],\n      dataEdit: [],\n      empoye: [],\n      checkLogin: \"\",\n      selectDate: \"\",\n      selectPoint: [],\n      view: [],\n      colums: [{\n        title: \"วันที่รับบริการ\",\n        dataIndex: \"service_date\"\n      }, {\n        title: \"เวลานัด\",\n        dataIndex: \"time_point_name\"\n      }, {\n        title: \"HN\",\n        dataIndex: \"service_hn\"\n      }, {\n        title: \"ชื่อ-สกุล\",\n        dataIndex: \"pname\"\n      }, {\n        title: \"อายุ\",\n        dataIndex: \"person_age\"\n      }, {\n        title: \"เบอร์ติดต่อ\",\n        dataIndex: \"person_phone\"\n      }, {\n        title: \"จุดรับบริการ\",\n        dataIndex: \"point_name\"\n      }, {\n        title: \"บริการ\",\n        dataIndex: \"service_name_order\"\n      }, {\n        title: \"แก้ไข\",\n        dataIndex: \"service_id\",\n        render: service_id => React.createElement(Button, {\n          onClick: () => this.Edits(service_id),\n          style: {\n            backgroundColor: \"#ff8080\"\n          },\n          type: \"danger\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 61\n          },\n          __self: this\n        }, \" \\u0E41\\u0E01\\u0E49\\u0E44\\u0E02\")\n      }],\n      editColum: [{\n        title: \"HN\",\n        dataIndex: \"service_hn\"\n      }, {\n        title: \"ชื่อ\",\n        dataIndex: \"pname\"\n      }, {\n        title: \"จุดนัด\",\n        dataIndex: \"point_name\"\n      }, {\n        title: \"วันที่นัด\",\n        dataIndex: \"service_date\",\n        render: () => React.createElement(DatePicker, {\n          style: {\n            width: 'auto'\n          },\n          onChange: this.dateEdit,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 80\n          },\n          __self: this\n        })\n      }, {\n        title: \"เวลานัด\",\n        dataIndex: \"\",\n        render: () => React.createElement(Select, {\n          showSearch: true,\n          style: {\n            width: 200\n          },\n          placeholder: \"Select a point\",\n          optionFilterProp: \"children\",\n          onSelect: e => this.timeEdit(e),\n          filterOption: (input, option) => option.props.children.toLowerCase().indexOf(input.toLowerCase()) >= 0,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 87\n          },\n          __self: this\n        }, this.state.time.map(a => React.createElement(Option, {\n          value: a.time_point_id,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 97\n          },\n          __self: this\n        }, a.time_point_name)))\n      }, {\n        title: \"ลบ\",\n        dataIndex: \"service_id\",\n        render: service_id => React.createElement(Popconfirm, {\n          title: \"\\u0E22\\u0E37\\u0E19\\u0E22\\u0E31\\u0E19\\u0E01\\u0E32\\u0E23\\u0E22\\u0E01\\u0E40\\u0E25\\u0E34\\u0E01?\",\n          onConfirm: () => this.confirmDel(service_id),\n          onCancel: this.confirmCancel,\n          placement: \"leftTop\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 104\n          },\n          __self: this\n        }, React.createElement(Tag, {\n          color: \"volcano\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 110\n          },\n          __self: this\n        }, \"\\u0E22\\u0E01\\u0E40\\u0E25\\u0E34\\u0E01\\u0E19\\u0E31\\u0E14\"))\n      }]\n    };\n  }\n\n  componentDidMount() {\n    const cookies = this.props.cookies;\n    let user = cookies.get('provider');\n    console.log(user);\n    this.setState({\n      selectDate: date,\n      userLogin: user\n    });\n    fetch(\"http://183.88.219.85:7078/appoint/view_appoint.php\", {\n      method: \"POST\",\n      body: JSON.stringify({\n        dates: date,\n        point: 1\n      })\n    }).then(view => view.json()).then(view => {\n      this.setState({\n        view: view\n      });\n    });\n    fetch(\"http://183.88.219.85:7078/appoint/service_point.php\").then(res1 => res1.json()).then(res1 => {\n      this.setState({\n        point: res1\n      });\n    });\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 312\n      },\n      __self: this\n    }, React.createElement(Card, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 313\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      style: {\n        textAlign: \"center\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 314\n      },\n      __self: this\n    }, \"\\u0E08\\u0E38\\u0E14\\u0E1A\\u0E23\\u0E34\\u0E01\\u0E32\\u0E23\\u0E17\\u0E31\\u0E19\\u0E15\\u0E01\\u0E23\\u0E23\\u0E21\"), React.createElement(\"div\", {\n      style: {\n        textAlign: \"center\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 315\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 316\n      },\n      __self: this\n    }, \"\\u0E27\\u0E31\\u0E19\\u0E17\\u0E35\\u0E48 :\", \" \", React.createElement(DatePicker, {\n      value: moment(this.state.selectDate),\n      style: {\n        width: 'auto'\n      },\n      onChange: this.dateChange,\n      cancelText: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 318\n      },\n      __self: this\n    })))), React.createElement(Table, {\n      columns: this.state.colums,\n      dataSource: this.state.view,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 326\n      },\n      __self: this\n    }), React.createElement(Modal, {\n      title: \"\\u0E41\\u0E01\\u0E49\\u0E44\\u0E02\",\n      okText: \"บันทึกการแก้ไข\",\n      cancelText: \"ปิด\",\n      visible: this.state.modal,\n      onOk: this.modalOk,\n      onCancel: this.modalCancal,\n      width: \"70%\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 327\n      },\n      __self: this\n    }, React.createElement(Table, {\n      columns: this.state.editColum,\n      dataSource: this.state.dataEdit,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 336\n      },\n      __self: this\n    })));\n  }\n\n}\n\nexport default withCookies(Dent);","map":{"version":3,"sources":["I:\\ANYcode\\react\\samroiyod_next-app\\src\\Components\\Dent.jsx"],"names":["React","Component","CookiesProvider","withCookies","Card","Modal","Input","Button","Col","message","Select","DatePicker","Table","Tag","Popconfirm","CryptoJS","Logo","moment","Option","date","Date","getFullYear","getMonth","slice","getDate","Dent","constructor","delCook","cookies","props","remove","dateChange","a","b","setState","selectDate","fetch","method","body","JSON","stringify","dates","point","then","view","json","Edits","e","console","log","modal","id","view_edit","dataEdit","dateEdit","pointEdit","state","map","service_pont","toString","time","timeEdit","modalOk","newTime","newDate","updateId","service_id","error","selectPoint","success","modalCancal","confirmDel","userUpdate","empoye","person_firstname","person_lastname","user","checkLogin","colums","title","dataIndex","render","backgroundColor","editColum","width","input","option","children","toLowerCase","indexOf","time_point_id","time_point_name","confirmCancel","componentDidMount","get","userLogin","res1","textAlign"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport { CookiesProvider, withCookies } from 'react-cookie'\r\nimport { Card, Modal, Input, Button, Col, message, Select, DatePicker, Table, Tag, Popconfirm } from 'antd'\r\nimport CryptoJS from 'crypto-js'\r\nimport Logo from '../favicon.ico'\r\nimport moment from 'moment'\r\nconst { Option } = Select;\r\nvar date = new Date()\r\ndate = `${date.getFullYear()}-${(\"0\" + (date.getMonth() + 1)).slice(-2)}-${(\"0\" + (date.getDate())).slice(-2)}`\r\nclass Dent extends Component {\r\n    constructor() {\r\n        super();\r\n        this.state = {\r\n            dateEdit: \"\",\r\n            timeEdit: \"\",\r\n            modal: false,\r\n            time: [],\r\n            point: [],\r\n            dataEdit: [],\r\n            empoye: [],\r\n            checkLogin: \"\",\r\n            selectDate: \"\",\r\n            selectPoint: [],\r\n            view: [],\r\n            colums: [\r\n                {\r\n                    title: \"วันที่รับบริการ\",\r\n                    dataIndex: \"service_date\"\r\n                },\r\n                {\r\n                    title: \"เวลานัด\",\r\n                    dataIndex: \"time_point_name\"\r\n                },\r\n                {\r\n                    title: \"HN\",\r\n                    dataIndex: \"service_hn\"\r\n                },\r\n                {\r\n                    title: \"ชื่อ-สกุล\",\r\n                    dataIndex: \"pname\"\r\n                },\r\n                {\r\n                    title: \"อายุ\",\r\n                    dataIndex: \"person_age\"\r\n                },\r\n                {\r\n                    title: \"เบอร์ติดต่อ\",\r\n                    dataIndex: \"person_phone\"\r\n                },\r\n                {\r\n                    title: \"จุดรับบริการ\",\r\n                    dataIndex: \"point_name\"\r\n                },\r\n                {\r\n                    title: \"บริการ\",\r\n                    dataIndex: \"service_name_order\"\r\n                },\r\n                {\r\n                    title: \"แก้ไข\",\r\n                    dataIndex: \"service_id\",\r\n                    render: service_id => (<Button onClick={() => this.Edits(service_id)} style={{ backgroundColor: \"#ff8080\" }} type=\"danger\"> แก้ไข</Button>)\r\n                }\r\n            ],\r\n            editColum: [\r\n                {\r\n                    title: \"HN\",\r\n                    dataIndex: \"service_hn\"\r\n                },\r\n                {\r\n                    title: \"ชื่อ\",\r\n                    dataIndex: \"pname\"\r\n                },\r\n                {\r\n                    title: \"จุดนัด\",\r\n                    dataIndex: \"point_name\"\r\n                },\r\n                {\r\n                    title: \"วันที่นัด\",\r\n                    dataIndex: \"service_date\",\r\n                    render: () => (<DatePicker\r\n                        style={{ width: 'auto' }}\r\n                        onChange={this.dateEdit} />)\r\n                },\r\n                {\r\n                    title: \"เวลานัด\",\r\n                    dataIndex: \"\",\r\n                    render: () => (<Select\r\n                        showSearch\r\n                        style={{ width: 200 }}\r\n                        placeholder=\"Select a point\"\r\n                        optionFilterProp=\"children\"\r\n                        onSelect={(e) => this.timeEdit(e)}\r\n                        filterOption={(input, option) =>\r\n                            option.props.children.toLowerCase().indexOf(input.toLowerCase()) >= 0\r\n                        }\r\n                    >\r\n                        {this.state.time.map(a => (<Option value={a.time_point_id}>{a.time_point_name}</Option>))}\r\n                    </Select>)\r\n                },\r\n                {\r\n                    title: \"ลบ\",\r\n                    dataIndex: \"service_id\",\r\n                    render: (service_id) => (\r\n                        <Popconfirm\r\n                            title=\"ยืนยันการยกเลิก?\"\r\n                            onConfirm={() => this.confirmDel(service_id)}\r\n                            onCancel={this.confirmCancel}\r\n                            placement=\"leftTop\"\r\n                        >\r\n                            <Tag color=\"volcano\">ยกเลิกนัด</Tag>\r\n                        </Popconfirm>\r\n                    )\r\n                }\r\n            ]\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        const { cookies } = this.props\r\n        let user = cookies.get('provider')\r\n        console.log(user)\r\n        this.setState({\r\n            selectDate: date,\r\n            userLogin: user\r\n        })\r\n        fetch(\"http://183.88.219.85:7078/appoint/view_appoint.php\", {\r\n            method: \"POST\",\r\n            body: JSON.stringify({\r\n                dates: date,\r\n                point: 1\r\n            })\r\n        }).then(view => view.json())\r\n            .then(view => {\r\n                this.setState({\r\n                    view: view\r\n                })\r\n            })\r\n        fetch(\"http://183.88.219.85:7078/appoint/service_point.php\")\r\n            .then(res1 => res1.json())\r\n            .then(res1 => {\r\n                this.setState({\r\n                    point: res1\r\n                })\r\n            })\r\n    }\r\n\r\n    delCook = () => {\r\n        const { cookies } = this.props;\r\n        cookies.remove('user')\r\n        cookies.remove('pass')\r\n    }\r\n\r\n    dateChange = (a, b) => {\r\n        //console.log(b)\r\n        if (b === \"\") {\r\n\r\n        } else {\r\n            this.setState({\r\n                selectDate: b\r\n            })\r\n            fetch(\"http://183.88.219.85:7078/appoint/view_appoint.php\", {\r\n                method: \"POST\",\r\n                body: JSON.stringify({\r\n                    dates: b,\r\n                    point: 1\r\n                })\r\n            }).then(view => view.json())\r\n                .then(view => {\r\n                    this.setState({\r\n                        view: view\r\n                    })\r\n                })\r\n        }\r\n    }\r\n\r\n    Edits = (e) => {\r\n        console.log(e)\r\n        this.setState({\r\n            modal: true\r\n        })\r\n        fetch(\"http://183.88.219.85:7078/appoint/view_edit.php\", {\r\n            method: \"POST\",\r\n            body: JSON.stringify({\r\n                id: e\r\n            })\r\n        })\r\n            .then(view_edit => view_edit.json())\r\n            .then(view_edit => {\r\n                this.setState({\r\n                    dataEdit: view_edit\r\n                })\r\n            })\r\n    }\r\n\r\n    dateEdit = (a, b) => {\r\n        this.setState({\r\n            dateEdit: b\r\n        })\r\n        fetch(\"http://183.88.219.85:7078/appoint/select_time_edit.php\", {\r\n            method: \"POST\",\r\n            body: JSON.stringify({\r\n                dateEdit: b,\r\n                pointEdit: this.state.dataEdit.map(a => a.service_pont).toString()\r\n            })\r\n        })\r\n            .then(time => time.json())\r\n            .then(time => {\r\n                this.setState({\r\n                    time: time\r\n                })\r\n            })\r\n    }\r\n\r\n    timeEdit = (e) => {\r\n        console.log(e)\r\n        this.setState({\r\n            timeEdit: e\r\n        })\r\n    }\r\n\r\n    modalOk = () => {\r\n        let newTime = this.state.timeEdit,\r\n            newDate = this.state.dateEdit,\r\n            updateId = this.state.dataEdit.map(a => a.service_id).toString()\r\n        if (newTime === \"\" || newDate === \"\" || updateId === \"\") {\r\n            message.error(\"แก้ไขข้อมูลผิดพลาด\")\r\n            console.log(newDate, newTime, updateId)\r\n        }\r\n        else {\r\n            fetch(\"http://183.88.219.85:7078/appoint/update_service.php\", {\r\n                method: \"POST\",\r\n                body: JSON.stringify({\r\n                    date: newDate,\r\n                    time: newTime,\r\n                    id: updateId\r\n                })\r\n            })\r\n                .then(() => (\r\n                    fetch(\"http://183.88.219.85:7078/appoint/view_appoint.php\", {\r\n                        method: \"POST\",\r\n                        body: JSON.stringify({\r\n                            dates: this.state.selectDate,\r\n                            point: this.state.selectPoint\r\n                        })\r\n                    })\r\n                        .then(view => view.json())\r\n                        .then(view => {\r\n                            this.setState({\r\n                                view: view\r\n                            })\r\n                        })\r\n                ))\r\n                .then(() => {\r\n                    message.success(\"UPDATE SUCCESS\")\r\n                    this.setState({\r\n                        dateEdit: \"\",\r\n                        timeEdit: \"\",\r\n                        time: []\r\n                    })\r\n                })\r\n        }\r\n        this.setState({\r\n            modal: false\r\n        })\r\n        console.log(newDate, newTime, updateId)\r\n    }\r\n\r\n    modalCancal = () => {\r\n        this.setState({\r\n            modal: false\r\n        })\r\n    }\r\n\r\n    confirmDel = (e) => {\r\n        console.log(e)\r\n        let userUpdate = this.state.empoye.map(a => (a.person_firstname) + \" \" + (a.person_lastname)).toString()\r\n        fetch(\"http://183.88.219.85:7078/appoint/cancel_appoint.php\", {\r\n            method: \"POST\",\r\n            body: JSON.stringify({\r\n                id: e.toString(),\r\n                user: userUpdate\r\n            })\r\n        })\r\n            .then(() => (\r\n                fetch(\"http://183.88.219.85:7078/appoint/view_appoint.php\", {\r\n                    method: \"POST\",\r\n                    body: JSON.stringify({\r\n                        dates: this.state.selectDate,\r\n                        point: this.state.selectPoint\r\n                    })\r\n                })\r\n                    .then(view => view.json())\r\n                    .then(view => {\r\n                        this.setState({\r\n                            view: view\r\n                        })\r\n                    })\r\n            ))\r\n            .then(() => {\r\n                message.success(\"ยกเลิกนัดสำเร็จ\")\r\n                this.setState({\r\n                    dateEdit: \"\",\r\n                    timeEdit: \"\",\r\n                    time: [],\r\n                    modal: false\r\n                })\r\n            })\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div>\r\n                <Card>\r\n                    <h1 style={{ textAlign: \"center\" }}>จุดบริการทันตกรรม</h1>\r\n                    <div style={{ textAlign: \"center\" }}>\r\n                        <h3>\r\n                            วันที่ :{\" \"}\r\n                            <DatePicker\r\n                                value={moment(this.state.selectDate)}\r\n                                style={{ width: 'auto' }}\r\n                                onChange={this.dateChange}\r\n                                cancelText={true} />\r\n                        </h3>\r\n                    </div>\r\n                </Card>\r\n                <Table columns={this.state.colums} dataSource={this.state.view} />\r\n                <Modal\r\n                    title=\"แก้ไข\"\r\n                    okText={\"บันทึกการแก้ไข\"}\r\n                    cancelText={\"ปิด\"}\r\n                    visible={this.state.modal}\r\n                    onOk={this.modalOk}\r\n                    onCancel={this.modalCancal}\r\n                    width={\"70%\"}\r\n                >\r\n                    <Table columns={this.state.editColum} dataSource={this.state.dataEdit} />\r\n                </Modal>\r\n            </div>\r\n        )\r\n    }\r\n\r\n}\r\nexport default withCookies(Dent)"]},"metadata":{},"sourceType":"module"}